df_plot <- data_migracion %>%
group_by(nombre_dpt) %>%
summarise(
carencia_ingresos  = sum(coalesce(carencia_ingresos, 0) == 1, na.rm = TRUE),
carencia_servicios = sum(coalesce(carencia_servicios, 0) == 1, na.rm = TRUE),
discriminacion     = sum(coalesce(discriminacion, 0) == 1, na.rm = TRUE),
.groups = "drop"
) %>%
pivot_longer(
cols = c(carencia_ingresos, carencia_servicios, discriminacion),
names_to = "motivo",
values_to = "casos"
) %>%
mutate(
motivo = recode(motivo,
carencia_ingresos  = "Carencia de ingresos",
carencia_servicios = "Carencia de servicios",
discriminacion     = "Discriminación"
)
) %>%
group_by(nombre_dpt) %>%
mutate(total_dpto = sum(casos)) %>%
ungroup() %>%
mutate(nombre_dpt = reorder(nombre_dpt, total_dpto))
migrar_por <- ggplot(df_plot, aes(x = casos, y = nombre_dpt, fill = motivo)) +
geom_col() +
scale_fill_manual(
values = c(
"Carencia de ingresos"  = "darkred",
"Carencia de servicios" = "#1F78B4",
"Discriminación"        = "darkgray"
)
) +
labs(
x = "Número de casos (personas)",
y = "Departamento",
fill = "Motivo",
title = "Casos reportados por departamento y tipo de vulneración"
) +
theme_minimal() +
theme(
panel.grid.major.y = element_blank(),
legend.position = "right",
plot.title = element_text(face = "bold")
)
ggsave("stores/motivo_migrar_nuevamente.png", migrar_por, width = 8, height = 6, dpi = 300)
rm (df_plot, migrar_por)
##############################################
# AÑOS
##############################################
data_migracion <- data_migracion %>%
mutate(
fecha_demo8 = ymd(demo8),   # convertir string a fecha
meses_transcurridos = interval(fecha_demo8, today()) %/% months(1),
anios_en_Col = meses_transcurridos / 12
)
#########################################
# MIGRAR EN PRÓXIMOS 6 MESES
#########################################
data_migracion <- data_migracion %>%
mutate(
`6M_sinmov`      = ifelse(demo22 == "no tienen la intencion de moverse", 1, 0),
`6M_Mudar_barrio`= ifelse(demo22 == "si, nos vamos a mudar de barrio al interior de esta ciudad", 1, 0),
`6M_Depto`       = ifelse(demo22 == "si, nos vamos a cambiar a otro departamento al interior de colombia", 1, 0),
`6M_Venezuela`   = ifelse(demo22 == "si, irnos a venezuela", 1, 0),
`6M_OtroPais`    = ifelse(demo22 == "si, irnos a otro pais (diferente a venezuela)", 1, 0),
`6M_MismoDpto`   = ifelse(demo22 == "si, nos vamos a cambiar de municipio pero en el mismo departamento actual", 1, 0)
)
#########################################
# HACE CUÁNTO TIEMPO RESIDE EN EL HOGAR
#########################################
data_migracion <- data_migracion %>%
mutate(
meses_en_lugar = case_when(
demo12a %in% c("no sabe", "prefiere no responder") ~ NA_character_,
demo12a == "menos de 1 mes" ~ "<1",
demo12a == "entre 1 mes y menos de 6 meses" ~ "1-6",
demo12a == "entre 6 meses y menos de 1 ano" ~ "6-12",
demo12a == "entre 1 ano y menos de 2 anos" ~ "12-24",
demo12a == "entre 2 y menos de 3 anos" ~ "24-36",
demo12a == "entre 3 y 10 anos" ~ "36-120",
demo12a == "mas de 10 anos" ~ ">120",
TRUE ~ NA_character_
),
meses_en_lugar = factor(
meses_en_lugar,
levels = c("<1", "1-6", "6-12", "12-24", "24-36", "36-120", ">120"),
ordered = TRUE
)
#########################################
# RAZÓN POR LA QUE MIGRÓ A RESIDENCIA ACTUAL
#########################################
data_migracion <- data_migracion %>%
mutate(
Migro_por_violencia = ifelse(demo17 %in% c(
"la persona o alguien cercano fue victima
de violencia (extorsion, agresiones, etc.) o amenazas",
"temor por la situacion general de violencia / inseguridad"), 1, 0),
Migro_por_familia = ifelse(demo17 %in% c(
"acompanar a otros miembros del hogar",
"reunificacion familiar"), 1, 0),
Migro_por_discriminacion = ifelse(demo17 %in% c(
"salud mental o fisica",
"temor de ser perseguido/a, agredido/a o discriminado/a"), 1, 0),
Migro_por_trabajo = ifelse(demo17 == "trabajo", 1, 0),
Migro_por_educacion = ifelse(demo17 == "educacion", 1, 0),
Migro_por_des_natural = ifelse(demo17 == "desastres naturales", 1, 0),
Migro_por_alimentos = ifelse(demo17 == "alimentos", 1, 0)
)
# Gráfico
df_plot_mig <- data_migracion %>%
group_by(nombre_dpt) %>%
summarise(
Migro_por_violencia      = sum(coalesce(Migro_por_violencia, 0) == 1, na.rm = TRUE),
Migro_por_familia        = sum(coalesce(Migro_por_familia, 0) == 1, na.rm = TRUE),
Migro_por_discriminacion = sum(coalesce(Migro_por_discriminacion, 0) == 1, na.rm = TRUE),
Migro_por_trabajo        = sum(coalesce(Migro_por_trabajo, 0) == 1, na.rm = TRUE),
Migro_por_educacion      = sum(coalesce(Migro_por_educacion, 0) == 1, na.rm = TRUE),
Migro_por_des_natural    = sum(coalesce(Migro_por_des_natural, 0) == 1, na.rm = TRUE),
Migro_por_alimentos      = sum(coalesce(Migro_por_alimentos, 0) == 1, na.rm = TRUE),
.groups = "drop"
) %>%
pivot_longer(
cols = starts_with("Migro_por"),
names_to = "motivo",
values_to = "casos"
) %>%
mutate(
motivo = recode(motivo,
Migro_por_violencia      = "Violencia / amenazas",
Migro_por_familia        = "Reunificación familiar",
Migro_por_discriminacion = "Discriminación / persecución",
Migro_por_trabajo        = "Trabajo",
Migro_por_educacion      = "Educación",
Migro_por_des_natural    = "Desastres naturales",
Migro_por_alimentos      = "Alimentos"
)
) %>%
group_by(nombre_dpt) %>%
mutate(total_dpto = sum(casos)) %>%
ungroup() %>%
mutate(nombre_dpt = reorder(nombre_dpt, total_dpto))
migro_por <- ggplot(df_plot_mig, aes(x = casos, y = nombre_dpt, fill = motivo)) +
geom_col() +
labs(
x = "Número de casos (personas)",
y = "Departamento",
fill = "Motivo de migración",
title = "Motivos de migración por departamento"
) +
scale_fill_manual(
values = c(
"Violencia / amenazas"           = "purple",
"Reunificación familiar"         = "red",
"Discriminación / persecución"   = "#7570b3",
"Trabajo"                        = "darkblue",
"Educación"                      = "gray",
"Desastres naturales"            = "darkgreen",
"Alimentos"                      = "salmon"
)
) +
theme_minimal() +
theme(
panel.grid.major.y = element_blank(),
legend.position = "right",
plot.title = element_text(face = "bold")
)
ggsave("stores/motivo_migracion.png", migro_por, width = 8, height = 6, dpi = 300)
rm (df_plot_mig, migro_por)
#########################################
# ACCESO A AGUA
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
Acueducto_casa = as.integer(any(wash1 == "agua de tuberia por grifo", na.rm = TRUE)),
AguaPublica_fueradecasa = as.integer(any(
wash1 %in% c("perforaciones / pozos tubulares (publicos)",
"pilas o fuentes publicas (fuentes publicas)"),
na.rm = TRUE
)),
Agua_FuentesNaturales = as.integer(any(
wash1 %in% c("agua de lluvia",
"agua superficial (rio, quebrada, manantial, lago)"),
na.rm = TRUE
)),
Agua_FuentesPrivadas = as.integer(any(
wash1 %in% c("agua envasada, agua embotellada y agua en bolsitas",
"de pozo sin bomba, aljibe, jaguey o barreno; (no protegido)",
"suministro de agua, incluidos camiones cisterna y carros / tanques / tambores pequenos"),
na.rm = TRUE
)),
Agua_NoAcceso = as.integer(any(wash1 == "no tiene acceso", na.rm = TRUE))
) %>%
ungroup()
#########################################
# AGUA EN VIVIENDA
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
Acceso_agua_casa = as.integer(any(wash01 == "si", na.rm = TRUE)),
No_Acceso_agua_casa = as.integer(any(wash01 == "no", na.rm = TRUE)),
Acceso_agua_casa_Otro = as.integer(any(wash01 %in% c("no sabe", "prefiere no responder"), na.rm = TRUE))
) %>%
ungroup()
#########################################
# TIEMPO PARA AGUA
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
Agua_caminar_largo = as.integer(any(wash3 == "mas de 30 minutos", na.rm = TRUE)),
Agua_caminar_corto = as.integer(any(wash3 == "menos de 30 minutos", na.rm = TRUE))
) %>%
ungroup()
#########################################
# SATISFACCIÓN NECESIDADES BÁSICAS AGUA
#########################################
data_migracion <- data_migracion %>%
mutate(
Agua_Satisfaccion = case_when(
wash5 == "si" ~ 1L,
wash5 == "no" ~ 0L,
TRUE ~ NA_integer_
)
#########################################
# TIEMPO DE COBERTURA DEL SERVICIO
#########################################
data_migracion <- data_migracion %>%
mutate(
Agua_CoberturaTotal = ifelse(
wash6 == "las 24 horas del dia, los 7 dias de la semana", 1L, 0L
),
Agua_CoberturaMedia = ifelse(
wash6 %in% c("llega a diario pero solo a ciertas horas del
dia/en horarios restringidos",
"las 24 horas de 4 a 6 dias a la semana"), 1L, 0L
),
Agua_MalaCobertura = ifelse(
wash6 %in% c("las 24 horas 1 a 2 dias a la semana",
"las 24 horas 3 dias a la semana"), 1L, 0L
)
#########################################
# INFORMACIÓN SANEAMIENTO
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
# Calidad
Saneamiento_deCalidad = as.integer(any(
wash11 %in% c("inodoro conectado a alcantarillado",
"inodoro conectado a pozo septico"),
na.rm = TRUE
)),
# No calidad
Saneamiento_noCalidad = as.integer(any(
wash11 %in% c("letrinas colgantes o inodoro con descarga directa a fuentes de agua (bajamar)",
"inodoro sin conexion (banos portatiles)",
"defecacion al aire libre",
"letrina de pozo con losa y plataforma",
"no tiene servicio sanitario, pero tiene un lugar gratuito y seguro",
"no tiene servicio sanitario y tiene que pagar el servicio",
"letrina improvisada"),
na.rm = TRUE
)),
# Letrinas
Saneamiento_Letrina = as.integer(any(
wash11 %in% c("letrinas colgantes o inodoro con descarga directa a fuentes de agua (bajamar)",
"inodoro sin conexion (banos portatiles)",
"letrina de pozo con losa y plataforma",
"letrina improvisada"),
na.rm = TRUE
)),
# Privado
Saneamiento_Privado = as.integer(any(
wash11 == "no tiene servicio sanitario y tiene que pagar el servicio",
na.rm = TRUE
)),
# Uso público
Saneamiento_UsoPublico = as.integer(any(
wash11 %in% c("no tiene servicio sanitario, pero tiene un lugar gratuito y seguro",
"inodoro sin conexion (banos portatiles)"),
na.rm = TRUE
)),
# Sin cobertura
Saneamiento_SinCobertura = as.integer(any(
wash11 %in% c("defecacion al aire libre",
"no tiene servicio sanitario, pero tiene un lugar gratuito y seguro",
"no tiene servicio sanitario y tiene que pagar el servicio"),
na.rm = TRUE
))
) %>%
ungroup()
#########################################
# SERVICIO DE BASURA
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
Servicio_basuraPublico = as.integer(any(
wash17 == "camion de basura municipal/punto de acopio formal",
na.rm = TRUE
)),
Servicio_basuraPrivado = as.integer(any(
wash17 == "servicio informal (punto de acopio no autorizado, recicladores/cartoneros)",
na.rm = TRUE
)),
Servicio_Nobasura = as.integer(any(
wash17 %in% c("no sabe",
"la tiran en la calle, via publica y/o rio",
"la queman o entierran"),
na.rm = TRUE
))) %>%
ungroup()
#########################################
# AMBIENTE CONTAMINADO
#########################################
data_migracion <- data_migracion %>%
group_by(id_hogar) %>%
mutate(
AmbienteContaminado = as.integer(any(
wash17 %in% c("la tiran en la calle, via publica y/o rio",
"la queman o entierran") |
wash11 %in% c("defecacion al aire libre",
"letrinas colgantes o inodoro con descarga directa a fuentes de agua (bajamar)"),
na.rm = TRUE
))
) %>%
ungroup()
#########################################
# PRBLEMAS PARA ACCEDER A ARTÍCULOS DE HIGIENE
#########################################
data_migracion <- data_migracion %>%
mutate(
wash20 = factor(
wash20,
levels = c("no (falta de jabon, lavamanos con agua)",
"si",
"utilizo gel antibacterial / toallas humedas / alcohol"),
labels = c("No (falta de jabón/agua)", "Sí", "Gel/Toallas/Alcohol"),
ordered = TRUE
)
# Intención de migrar en 6 meses
resumen_intencion_6M <- data_migracion %>%
group_by(intro5) %>%
summarise(
sinmov = sum(`6M_sinmov`, na.rm = TRUE),
mudar_barrio = sum(`6M_Mudar_barrio`, na.rm = TRUE),
depto = sum(`6M_Depto`, na.rm = TRUE),
venezuela = sum(`6M_Venezuela`, na.rm = TRUE),
otro_pais = sum(`6M_OtroPais`, na.rm = TRUE),
mismo_dpto = sum(`6M_MismoDpto`, na.rm = TRUE),
.groups = "drop"
)
resumen_intencion_6M
# Tiempo de residencia en lugar en que se encuentra actualmente
resumen_meses_lugar <- data_migracion %>%
group_by(intro5, meses_en_lugar) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(intro5) %>%
mutate(
pct = round(100 * n / sum(n), 1)   # porcentaje dentro de cada ciudad
) %>%
arrange(intro5, meses_en_lugar)
resumen_meses_lugar
# Motivo por el que migró a residencia actual
resumen_motivos <- data_migracion %>%
group_by(intro5) %>%
summarise(
violencia      = sum(Migro_por_violencia, na.rm = TRUE),
familia        = sum(Migro_por_familia, na.rm = TRUE),
discriminacion = sum(Migro_por_discriminacion, na.rm = TRUE),
trabajo        = sum(Migro_por_trabajo, na.rm = TRUE),
educacion      = sum(Migro_por_educacion, na.rm = TRUE),
des_natural    = sum(Migro_por_des_natural, na.rm = TRUE),
alimentos      = sum(Migro_por_alimentos, na.rm = TRUE),
.groups = "drop"
)
# ACCESO A AGUA
resumen_agua <- data_migracion %>%
distinct(id_hogar, intro5, Acueducto_casa, AguaPublica_fueradecasa,
Agua_FuentesNaturales, Agua_FuentesPrivadas, Agua_NoAcceso) %>%
group_by(intro5) %>%
summarise(
hogares_con_Acueducto = sum(Acueducto_casa, na.rm = TRUE),
hogares_con_AguaPublica_fuera = sum(AguaPublica_fueradecasa, na.rm = TRUE),
hogares_con_AguaNatural = sum(Agua_FuentesNaturales, na.rm = TRUE),
hogares_con_AguaPrivada = sum(Agua_FuentesPrivadas, na.rm = TRUE),
hogares_sin_Agua = sum(Agua_NoAcceso, na.rm = TRUE),
total_hogares = n(),
.groups = "drop"
) %>%
mutate(
pct_Acueducto = round(100 * hogares_con_Acueducto / total_hogares, 1),
pct_AguaPublica_fuera = round(100 * hogares_con_AguaPublica_fuera / total_hogares, 1),
pct_AguaNatural = round(100 * hogares_con_AguaNatural / total_hogares, 1),
pct_AguaPrivada = round(100 * hogares_con_AguaPrivada / total_hogares, 1),
pct_NoAcceso = round(100 * hogares_sin_Agua / total_hogares, 1)
)
# CAMINAR PARA ACCEDER A AGUA (CORTO < 30 MIN, LARGO > 30 MIN)
resumen_caminar <- data_migracion %>%
distinct(id_hogar, intro5, Agua_caminar_largo, Agua_caminar_corto) %>%
group_by(intro5) %>%
summarise(
hogares_largo = sum(Agua_caminar_largo, na.rm = TRUE),
hogares_corto = sum(Agua_caminar_corto, na.rm = TRUE),
total_hogares = n(),
.groups = "drop"
) %>%
mutate(
pct_largo = round(100 * hogares_largo / total_hogares, 1),
pct_corto = round(100 * hogares_corto / total_hogares, 1)
) %>%
arrange(desc(total_hogares))
resumen_caminar
# ACCESO A SANEAMIENTO
resumen_saneamiento <- data_migracion %>%
distinct(id_hogar, intro5,
Saneamiento_deCalidad, Saneamiento_noCalidad,
Saneamiento_Letrina, Saneamiento_Privado,
Saneamiento_UsoPublico, Saneamiento_SinCobertura) %>%
group_by(intro5) %>%
summarise(
hogares_deCalidad     = sum(Saneamiento_deCalidad, na.rm = TRUE),
hogares_noCalidad     = sum(Saneamiento_noCalidad, na.rm = TRUE),
hogares_Letrina       = sum(Saneamiento_Letrina, na.rm = TRUE),
hogares_Privado       = sum(Saneamiento_Privado, na.rm = TRUE),
hogares_UsoPublico    = sum(Saneamiento_UsoPublico, na.rm = TRUE),
hogares_SinCobertura  = sum(Saneamiento_SinCobertura, na.rm = TRUE),
total_hogares         = n(),
.groups = "drop"
) %>%
mutate(
pct_deCalidad    = round(100 * hogares_deCalidad / total_hogares, 1),
pct_noCalidad    = round(100 * hogares_noCalidad / total_hogares, 1),
pct_Letrina      = round(100 * hogares_Letrina / total_hogares, 1),
pct_Privado      = round(100 * hogares_Privado / total_hogares, 1),
pct_UsoPublico   = round(100 * hogares_UsoPublico / total_hogares, 1),
pct_SinCobertura = round(100 * hogares_SinCobertura / total_hogares, 1)
) %>%
arrange(desc(total_hogares))
resumen_saneamiento
# Número de miembros en promedio por hogar
hogares <- data_migracion_sf %>%
st_drop_geometry() %>%
group_by(id_hogar, nombre_dpt) %>%
summarise(personas_hogar = n(), .groups = "drop")
# Promedio por departamento
prom_dpto <- hogares %>%
group_by(nombre_dpt) %>%
summarise(prom_personas_hogar = mean(personas_hogar), .groups = "drop")
mapa_prom <- deptos_sf %>%
left_join(prom_dpto, by = "nombre_dpt")
ggplot(mapa_prom) +
geom_sf(aes(fill = prom_personas_hogar), color = "white", linewidth = 0.2) +
scale_fill_viridis_c(option = "C", na.value = "grey90",
name = "Promedio\npersonas\npor hogar") +
labs(
title = "Promedio de personas por hogar por departamento",
subtitle = "Población migrante venezolana en Colombia",
caption = "Fuente: data_migracion_sf"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
legend.position = "right"
)
View(prom_dpto)
ggsave("stores/motivo_migracion.png", personas_por_hogar, width = 8, height = 6, dpi = 300)
personas_por_hogar <- ggplot(mapa_prom) +
geom_sf(aes(fill = prom_personas_hogar), color = "white", linewidth = 0.2) +
scale_fill_viridis_c(option = "C", na.value = "grey90",
name = "Promedio\npersonas\npor hogar") +
labs(
title = "Promedio de personas por hogar por departamento",
subtitle = "Población migrante venezolana en Colombia",
caption = "Fuente: data_migracion_sf"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
legend.position = "right"
)
ggsave("stores/motivo_migracion.png", personas_por_hogar, width = 8, height = 6, dpi = 300)
rm(personas_por_hogar,mapa_prom,prom_dpto,hogares)
ggsave("stores/personas_por_hogar.png", personas_por_hogar, width = 8, height = 6, dpi = 300)
hogares <- data_migracion_sf %>%
st_drop_geometry() %>%
group_by(id_hogar, nombre_dpt) %>%
summarise(personas_hogar = n(), .groups = "drop")
prom_dpto <- hogares %>% # Promedio por departamento
group_by(nombre_dpt) %>%
summarise(prom_personas_hogar = mean(personas_hogar), .groups = "drop")
mapa_prom <- deptos_sf %>%
left_join(prom_dpto, by = "nombre_dpt")
personas_por_hogar <- ggplot(mapa_prom) +
geom_sf(aes(fill = prom_personas_hogar), color = "white", linewidth = 0.2) +
scale_fill_viridis_c(option = "C", na.value = "grey90",
name = "Promedio\npersonas\npor hogar") +
labs(
title = "Promedio de personas por hogar por departamento",
subtitle = "Población migrante venezolana en Colombia",
caption = "Fuente: data_migracion_sf"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 14, face = "bold"),
legend.position = "right"
)
ggsave("stores/personas_por_hogar.png", personas_por_hogar, width = 8, height = 6, dpi = 300)
rm(personas_por_hogar,mapa_prom,prom_dpto,hogares)
